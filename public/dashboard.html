
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0a0a0a">
  <title>Aroodes Dashboard</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=IM+Fell+English&display=swap" rel="stylesheet">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body {
      font-family: 'IM Fell English', serif;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      color: #e9e9e9;
      min-height: 100vh;
    }
    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    .title-font { font-family: 'Cinzel Decorative', serif; }
    .glass {
      background: rgba(30, 30, 50, 0.85);
      backdrop-filter: blur(10px);
      border: 2px solid #d4af37;
    }
    .glow { box-shadow: 0 0 20px rgba(212, 175, 55, 0.3); }
    .glow-hover:hover {
      box-shadow: 0 0 30px rgba(212, 175, 55, 0.5);
      transform: translateY(-5px);
    }
    @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
    @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
    .pulse { animation: pulse 2s ease-in-out infinite; }
    .float { animation: float 3s ease-in-out infinite; }
    .pathway-image {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.3));
    }
    ::-webkit-scrollbar { width: 10px; }
    ::-webkit-scrollbar-track { background: #1a1a2e; }
    ::-webkit-scrollbar-thumb { 
      background: linear-gradient(180deg, #d4af37 0%, #8b4513 100%);
      border-radius: 5px;
    }
    .skeleton {
      background: linear-gradient(90deg, #1a1410 25%, #2a1810 50%, #1a1410 75%);
      background-size: 200% 100%;
      animation: skeleton-loading 1.5s ease-in-out infinite;
    }
    @keyframes skeleton-loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
  </style>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#d4af37',
            dark: '#1a1a2e',
            darker: '#16213e'
          }
        }
      }
    }
  </script>
</head>
<body class="min-h-screen">
  
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;
    const API_BASE = window.location.origin + '/api';

    const PATHWAYS = [
      { id: 'fool', name: 'The Fool', image: '/pathways/fool.png', color: 'from-yellow-600 to-yellow-800' },
      { id: 'error', name: 'Error', image: '/pathways/error.png', color: 'from-purple-600 to-purple-900' },
      { id: 'door', name: 'Door', image: '/pathways/door.png.webp', color: 'from-cyan-600 to-indigo-800' },
      { id: 'visionary', name: 'Visionary', image: '/pathways/visionary.png.webp', color: 'from-purple-500 to-purple-800' },
      { id: 'sun', name: 'The Sun', image: '/pathways/sun.png.webp', color: 'from-yellow-400 to-red-600' },
      { id: 'tyrant', name: 'Tyrant', image: '/pathways/tyrant.png.webp', color: 'from-blue-600 to-blue-900' },
      { id: 'white_tower', name: 'White Tower', image: '/pathways/white_tower.png.webp', color: 'from-gray-300 to-gray-600' },
      { id: 'hanged_man', name: 'Hanged Man', image: '/pathways/hanged_man.png', color: 'from-teal-500 to-blue-700' },
      { id: 'darkness', name: 'Darkness', image: '/pathways/darkness.png.webp', color: 'from-gray-700 to-black' },
      { id: 'death', name: 'Death', image: '/pathways/death.png', color: 'from-gray-600 to-black' },
      { id: 'twilight', name: 'Twilight Giant', image: '/pathways/twilight_giant.png.webp', color: 'from-orange-600 to-red-900' },
      { id: 'demoness', name: 'Demoness', image: '/pathways/demoness.png.webp', color: 'from-pink-500 to-purple-900' },
      { id: 'red_priest', name: 'Red Priest', image: '/pathways/red_priest.png', color: 'from-red-500 to-red-900' },
      { id: 'moon', name: 'The Moon', image: '/pathways/moon.png', color: 'from-purple-400 to-purple-800' },
      { id: 'mother', name: 'Mother', image: '/pathways/mother.png.webp', color: 'from-green-500 to-green-900' },
      { id: 'abyss', name: 'Abyss', image: '/pathways/abyss.png.webp', color: 'from-gray-800 to-gray-900' },
      { id: 'chained', name: 'Chained', image: '/pathways/chained.png.webp', color: 'from-gray-600 to-black' },
      { id: 'justiciar', name: 'Justiciar', image: '/pathways/justiciar.png.webp', color: 'from-yellow-500 to-orange-700' },
      { id: 'paragon', name: 'Paragon', image: '/pathways/paragon.png.webp', color: 'from-slate-400 to-slate-800' },
      { id: 'black_emperor', name: 'Black Emperor', image: '/pathways/black_emperor.png.webp', color: 'from-purple-800 to-black' },
      { id: 'hermit', name: 'The Hermit', image: '/pathways/hermit.png.webp', color: 'from-amber-600 to-brown-900' },
      { id: 'wheel', name: 'Wheel of Fortune', image: '/pathways/wheel_of_fortune.png.webp', color: 'from-emerald-500 to-cyan-900' }
    ];

    function App() {
      const [activeTab, setActiveTab] = useState('dashboard');
      const [stats, setStats] = useState(null);
      const [beyonders, setBeyonders] = useState([]);
      const [leaderboard, setLeaderboard] = useState([]);
      const [loading, setLoading] = useState(true);
      const [selectedUser, setSelectedUser] = useState(null);
      const [searchTerm, setSearchTerm] = useState('');

      useEffect(() => {
        fetchAllData();
        const interval = setInterval(fetchAllData, 30000);
        return () => clearInterval(interval);
      }, []);

      const fetchAllData = async () => {
        try {
          const [statsRes, beyondersRes, leaderboardRes] = await Promise.all([
            fetch(`${API_BASE}/stats`),
            fetch(`${API_BASE}/beyonders`),
            fetch(`${API_BASE}/leaderboard/sequence`)
          ]);
          const statsData = await statsRes.json();
          const beyondersData = await beyondersRes.json();
          const leaderboardData = await leaderboardRes.json();
          setStats(statsData);
          setBeyonders(beyondersData);
          setLeaderboard(leaderboardData);
          setLoading(false);
        } catch (error) {
          console.error('Error:', error);
          setLoading(false);
        }
      };

      return (
        <div className="min-h-screen">
          <Navbar activeTab={activeTab} setActiveTab={setActiveTab} />
          <div className="max-w-7xl mx-auto px-4 py-8">
            {loading ? (
              <LoadingScreen />
            ) : (
              <>
                {activeTab === 'dashboard' && <Dashboard stats={stats} />}
                {activeTab === 'beyonders' && <Beyonders beyonders={beyonders} onSelectUser={setSelectedUser} searchTerm={searchTerm} setSearchTerm={setSearchTerm} />}
                {activeTab === 'leaderboard' && <Leaderboard leaderboard={leaderboard} />}
                {activeTab === 'pathways' && <PathwaysGallery />}
              </>
            )}
          </div>
          {selectedUser && <UserProfileModal user={selectedUser} onClose={() => setSelectedUser(null)} />}
        </div>
      );
    }

    function Navbar({ activeTab, setActiveTab }) {
      const [menuOpen, setMenuOpen] = useState(false);
      const tabs = [
        { id: 'dashboard', name: 'Dashboard', icon: 'üìä' },
        { id: 'pathways', name: 'Pathways', icon: 'üé≠' },
        { id: 'beyonders', name: 'Beyonders', icon: 'üë•' },
        { id: 'leaderboard', name: 'Leaderboard', icon: 'üèÜ' }
      ];

      return (
        <nav className="glass sticky top-0 z-50 glow">
          <div className="max-w-7xl mx-auto px-4 py-4">
            <div className="flex justify-between items-center">
              <h1 className="text-xl md:text-3xl title-font text-primary float">üåô Aroodes Dashboard</h1>
              <div className="hidden md:flex gap-2">
                {tabs.map(tab => (
                  <button key={tab.id} onClick={() => setActiveTab(tab.id)} className={`px-4 py-2 rounded-lg transition ${activeTab === tab.id ? 'bg-primary text-dark' : 'hover:bg-primary/20'}`}>
                    {tab.icon} {tab.name}
                  </button>
                ))}
                <a href="/" className="px-4 py-2 rounded-lg bg-primary/20 hover:bg-primary/30 transition">‚Üê Back</a>
              </div>
              <button onClick={() => setMenuOpen(!menuOpen)} className="md:hidden text-2xl text-primary">{menuOpen ? '‚úï' : '‚ò∞'}</button>
            </div>
            {menuOpen && (
              <div className="md:hidden mt-4 space-y-2">
                {tabs.map(tab => (
                  <button key={tab.id} onClick={() => { setActiveTab(tab.id); setMenuOpen(false); }} className={`w-full text-left px-4 py-2 rounded-lg transition ${activeTab === tab.id ? 'bg-primary text-dark' : 'hover:bg-primary/20'}`}>
                    {tab.icon} {tab.name}
                  </button>
                ))}
                <a href="/" className="block w-full text-left px-4 py-2 rounded-lg bg-primary/20">‚Üê Back</a>
              </div>
            )}
          </div>
        </nav>
      );
    }

    function LoadingScreen() {
      return (
        <div className="text-center py-20">
          <div className="text-6xl mb-6 pulse">üåô</div>
          <div className="text-3xl text-primary animate-pulse title-font">Loading...</div>
        </div>
      );
    }

    function Dashboard({ stats }) {
      if (!stats) return null;
      return (
        <div className="space-y-8">
          <h2 className="text-3xl md:text-4xl title-font text-primary text-center mb-8">üìä Server Overview</h2>
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
            <StatCard icon="üîÆ" title="Total Beyonders" value={stats.totalBeyonders} />
            <StatCard icon="üëº" title="Angels" value={stats.angels} />
            <StatCard icon="‚öúÔ∏è" title="True Gods" value={stats.trueGods} />
            <StatCard icon="üìà" title="Avg Sequence" value={stats.averageSequence.toFixed(1)} />
          </div>
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div className="glass rounded-xl p-6 glow-hover transition">
              <h3 className="text-xl title-font text-primary mb-4">üé≠ Pathway Distribution</h3>
              <div className="space-y-3">
                {stats.pathwayDistribution.slice(0, 10).map((pathway, i) => (
                  <div key={i} className="flex items-center gap-4">
                    <div className="w-32 text-sm capitalize truncate">{pathway.pathway}</div>
                    <div className="flex-1 bg-gray-700 rounded-full h-6">
                      <div className="bg-gradient-to-r from-primary to-yellow-500 h-full flex items-center justify-end px-2 text-xs font-bold" style={{ width: `${(pathway.count / stats.totalBeyonders * 100)}%` }}>
                        {pathway.count}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
            <div className="glass rounded-xl p-6 glow-hover transition">
              <h3 className="text-xl title-font text-primary mb-4">üìä Sequence Distribution</h3>
              <div className="space-y-3">
                {stats.sequenceDistribution.sort((a, b) => a.sequence - b.sequence).map((seq, i) => (
                  <div key={i} className="flex items-center gap-4">
                    <div className="w-24 text-sm">{seq.sequence === 0 ? '‚öúÔ∏è Seq 0' : seq.sequence <= 3 ? 'üëº Seq ' + seq.sequence : 'üîÆ Seq ' + seq.sequence}</div>
                    <div className="flex-1 bg-gray-700 rounded-full h-6">
                      <div className={`h-full flex items-center justify-end px-2 text-xs font-bold ${seq.sequence === 0 ? 'bg-red-600' : seq.sequence <= 3 ? 'bg-yellow-500' : 'bg-blue-500'}`} style={{ width: `${(seq.count / stats.totalBeyonders * 100)}%` }}>
                        {seq.count}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    }

    function StatCard({ icon, title, value }) {
      return (
        <div className="glass rounded-xl p-6 hover:scale-105 transition glow-hover">
          <div className="flex items-center gap-4">
            <div className="text-5xl">{icon}</div>
            <div>
              <div className="text-gray-400 text-sm">{title}</div>
              <div className="text-3xl font-bold text-primary">{value}</div>
            </div>
          </div>
        </div>
      );
    }

    function PathwaysGallery() {
      const [selected, setSelected] = useState(null);
      return (
        <div className="space-y-8">
          <h2 className="text-3xl md:text-4xl title-font text-primary text-center">üé≠ All 22 Pathways</h2>
          <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
            {PATHWAYS.map(p => (
              <PathwayCard key={p.id} pathway={p} onClick={() => setSelected(p)} />
            ))}
          </div>
          {selected && <PathwayModal pathway={selected} onClose={() => setSelected(null)} />}
        </div>
      );
    }

    function PathwayCard({ pathway, onClick }) {
      const [loaded, setLoaded] = useState(false);
      return (
        <div onClick={onClick} className="glass rounded-xl p-4 cursor-pointer glow-hover transition group">
          <div className="h-32 flex items-center justify-center mb-3 bg-black/30 rounded-lg overflow-hidden">
            {!loaded && <div className="skeleton w-full h-full"></div>}
            <img src={pathway.image} alt={pathway.name} className={`pathway-image group-hover:scale-110 transition ${loaded ? 'opacity-100' : 'opacity-0'}`} onLoad={() => setLoaded(true)} />
          </div>
          <h3 className="title-font text-center text-primary text-sm mb-2">{pathway.name}</h3>
          <div className={`h-2 rounded-full bg-gradient-to-r ${pathway.color}`}></div>
        </div>
      );
    }

    function PathwayModal({ pathway, onClose }) {
      return (
        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90" onClick={onClose}>
          <div className="glass rounded-2xl p-8 max-w-2xl w-full" onClick={e => e.stopPropagation()}>
            <button onClick={onClose} className="float-right text-3xl text-primary hover:text-yellow-500">‚úï</button>
            <div className="text-center">
              <div className="h-48 flex items-center justify-center mb-6">
                <img src={pathway.image} alt={pathway.name} className="pathway-image max-h-full" />
              </div>
              <h2 className="text-4xl title-font text-primary mb-4">{pathway.name}</h2>
              <div className={`h-3 rounded-full bg-gradient-to-r ${pathway.color} mb-6`}></div>
              <p className="text-gray-300 italic">One of the 22 pathways to divinity.</p>
            </div>
          </div>
        </div>
      );
    }
    
